

# athena
`import "github.com/cognusion/prochydra/athena"`

* [Overview](#pkg-overview)
* [Index](#pkg-index)
* [Examples](#pkg-examples)

## <a name="pkg-overview">Overview</a>
Package athena is a system to track the PSS memory usage of an os.Process
and kill it if the usage exceeds the stated Limit. Limits may be cancelled and
new Limits estabilished.




## <a name="pkg-index">Index</a>
* [type MemoryGuard](#MemoryGuard)
  * [func NewMemoryGuard(Process *os.Process) *MemoryGuard](#NewMemoryGuard)
  * [func (m *MemoryGuard) Cancel()](#MemoryGuard.Cancel)
  * [func (m *MemoryGuard) Limit(max int64)](#MemoryGuard.Limit)
  * [func (m *MemoryGuard) PSS() int64](#MemoryGuard.PSS)
  * [func (m *MemoryGuard) SetNoKill()](#MemoryGuard.SetNoKill)
  * [func (m *MemoryGuard) StatsFrequency(freq time.Duration)](#MemoryGuard.StatsFrequency)

#### <a name="pkg-examples">Examples</a>
* [MemoryGuard](#example-memoryguard)

#### <a name="pkg-files">Package files</a>
[athena.go](https://github.com/cognusion/prochydra/tree/master/athena/athena.go)






## <a name="MemoryGuard">type</a> [MemoryGuard](https://github.com/cognusion/prochydra/tree/master/athena/athena.go?s=413:1014#L20)
``` go
type MemoryGuard struct {
    // Name is a name to use in lieu of PID for messaging
    Name string
    // Interval is a time.Duration to wait between checking usage
    Interval time.Duration
    // DebugOut is a logger for debug information
    DebugOut *log.Logger
    // ErrOut is a logger for StdErr coming from a process
    ErrOut *log.Logger
    // KillChan will be closed if/when the process is killed
    KillChan chan struct{}
    // contains filtered or unexported fields
}

```
MemoryGuard is our encapsulating mechanation, and should only be acquired via a New helper



##### Example MemoryGuard:
``` go
// Get a handle on our process
us, _ := os.FindProcess(os.Getpid())

// Create a new MemoryGuard around the process
mg := NewMemoryGuard(us)
mg.Limit(512 * 1024 * 1024) // Set the HWM memory limit. You can change this at any time

// Do stuff that is memory-hungry

// Stop guarding. After this, if you want to guard the process,
// you need to NewMemoryGuard() again
mg.Cancel()
```





### <a name="NewMemoryGuard">func</a> [NewMemoryGuard](https://github.com/cognusion/prochydra/tree/master/athena/athena.go?s=1097:1150#L40)
``` go
func NewMemoryGuard(Process *os.Process) *MemoryGuard
```
NewMemoryGuard takes an os.Process and returns a MemoryGuard for that process





### <a name="MemoryGuard.Cancel">func</a> (\*MemoryGuard) [Cancel](https://github.com/cognusion/prochydra/tree/master/athena/athena.go?s=2235:2265#L79)
``` go
func (m *MemoryGuard) Cancel()
```
Cancel stops any Limit() operations. After calling Cancel this
MemoryGuard will be non-functional




### <a name="MemoryGuard.Limit">func</a> (\*MemoryGuard) [Limit](https://github.com/cognusion/prochydra/tree/master/athena/athena.go?s=2476:2514#L90)
``` go
func (m *MemoryGuard) Limit(max int64)
```
Limit takes the max usage (in Bytes) for the process.
and acts on the PSS of the process uness UseRSS is true




### <a name="MemoryGuard.PSS">func</a> (\*MemoryGuard) [PSS](https://github.com/cognusion/prochydra/tree/master/athena/athena.go?s=1953:1986#L66)
``` go
func (m *MemoryGuard) PSS() int64
```
PSS returns the last known PSS value for the watched process,
or the current value, if there was no last value




### <a name="MemoryGuard.SetNoKill">func</a> (\*MemoryGuard) [SetNoKill](https://github.com/cognusion/prochydra/tree/master/athena/athena.go?s=1567:1600#L54)
``` go
func (m *MemoryGuard) SetNoKill()
```
SetNoKill changes the default behavior of the MemoryGuard, to not kill the
process if it exceeds the specified limit.




### <a name="MemoryGuard.StatsFrequency">func</a> (\*MemoryGuard) [StatsFrequency](https://github.com/cognusion/prochydra/tree/master/athena/athena.go?s=1749:1805#L60)
``` go
func (m *MemoryGuard) StatsFrequency(freq time.Duration)
```
StatsFrequency updates the internal frequency to which statistics are emitted to
the debug logger. Default is 1 minute.








- - -
Generated by [godoc2md](http://github.com/cognusion/godoc2md)
